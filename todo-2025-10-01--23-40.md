# TODO: Create icmwriper-5 Command
Created: 2025-10-01 23:40

## Comprehensive Technical Specification for `icmwriper-5` Command

### Overview
Create a bash script that will be installed as a global command at `/usr/local/bin/icmwriper-5`.

### Detailed Implementation Plan

#### Script Structure

**File Location**: `/usr/local/bin/icmwriper-5`

**Shebang**: `#!/usr/bin/env bash`

**Script Logic**:

1. **Argument Validation**
   - Check if exactly 2 arguments are provided
   - If not, print usage message: "Usage: icmwriper-5 generate <project-name>" and exit with code 1
   - Check if first argument is "generate"
   - If not, print error: "Error: Unknown command '$1'. Only 'generate' is supported." and exit with code 1
   - Store second argument as PROJECT_NAME variable

2. **Project Directory Validation**
   - Check if directory "$PROJECT_NAME" already exists in current directory
   - If exists, print error: "Error: Directory '$PROJECT_NAME' already exists." and exit with code 1

3. **GitHub Repository Configuration**
   - Define constant: GITHUB_RAW_URL="https://raw.githubusercontent.com/wubin28/ICMwRIPER-5/main"
   - Define array of files to download:
     - "icm-bubble-template.md"
     - "icm-story-template.md"
     - "icmwriper-5.md"
     - "README.md"

4. **Directory Creation**
   - Create directory "$PROJECT_NAME" using `mkdir "$PROJECT_NAME"`
   - If creation fails, print error: "Error: Failed to create directory '$PROJECT_NAME'." and exit with code 1

5. **File Download Loop**
   - For each file in the files array:
     - Construct full URL: "$GITHUB_RAW_URL/$filename"
     - Use curl to download: `curl -f -sS -o "$PROJECT_NAME/$filename" "$url"`
     - If curl fails (non-zero exit code):
       - Print error: "Error: Failed to download $filename from GitHub. Please check your internet connection and repository availability."
       - Remove the partially created directory: `rm -rf "$PROJECT_NAME"`
       - Exit with code 1

6. **File Renaming**
   - Rename "$PROJECT_NAME/README.md" to "$PROJECT_NAME/icmwriper-5-README.md"
   - Use command: `mv "$PROJECT_NAME/README.md" "$PROJECT_NAME/icmwriper-5-README.md"`

7. **Success Message**
   - Print: "Success: Project '$PROJECT_NAME' created with ICMwRIPER-5 template files."
   - Exit with code 0

#### Installation Steps

1. Create the script file at `/tmp/icmwriper-5` (temporary location for creation)
2. Set executable permissions: `chmod +x /tmp/icmwriper-5`
3. Test the script in /tmp location
4. Move to final location: `sudo mv /tmp/icmwriper-5 /usr/local/bin/icmwriper-5`
5. Verify installation: `which icmwriper-5`

---

## IMPLEMENTATION CHECKLIST:

- [ ] 1. Create bash script file at `/tmp/icmwriper-5` with shebang `#!/usr/bin/env bash`
- [ ] 2. Add argument count validation (check for exactly 2 arguments)
- [ ] 3. Add usage message for incorrect argument count
- [ ] 4. Add subcommand validation (check first argument is "generate")
- [ ] 5. Add error message for unknown subcommands
- [ ] 6. Store second argument as PROJECT_NAME variable
- [ ] 7. Add directory existence check for PROJECT_NAME
- [ ] 8. Add error message for existing directory
- [ ] 9. Define GITHUB_RAW_URL constant as "https://raw.githubusercontent.com/wubin28/ICMwRIPER-5/main"
- [ ] 10. Define FILES array with 4 filenames: icm-bubble-template.md, icm-story-template.md, icmwriper-5.md, README.md
- [ ] 11. Create project directory with `mkdir "$PROJECT_NAME"`
- [ ] 12. Add error handling for directory creation failure
- [ ] 13. Implement for loop to iterate through FILES array
- [ ] 14. In loop: construct download URL for each file
- [ ] 15. In loop: use curl with flags -f -sS -o to download each file
- [ ] 16. In loop: add error handling for curl failure with cleanup (remove directory) and exit
- [ ] 17. Rename README.md to icmwriper-5-README.md using mv command
- [ ] 18. Add success message with project name
- [ ] 19. Set executable permissions on script with `chmod +x /tmp/icmwriper-5`
- [ ] 20. Move script to /usr/local/bin/ using sudo: `sudo mv /tmp/icmwriper-5 /usr/local/bin/icmwriper-5`
- [ ] 21. Verify installation with `which icmwriper-5`

---

## REVIEW SECTION
(To be filled during EXECUTE mode)
