# TODO: Convert icmwriper-5-for-ubuntu to macOS Version

## Implementation Checklist:

1. [ ] Copy the Ubuntu script to create macOS version
2. [ ] Update usage message to reference correct script name
3. [ ] Modify first sed command to use macOS syntax (line 111)
4. [ ] Modify second sed command to use macOS syntax (line 157)
5. [ ] Verify script permissions are executable
6. [ ] Test all four subcommands on macOS

## Technical Details:

**Primary Change**: Ubuntu `sed -i` → macOS `sed -i ''`

**Affected Lines:**
- Line 5: Usage message script name
- Line 111: First sed command in bubble subcommand
- Line 157: Second sed command in snb subcommand

**Source**: `/Users/binwu/OOR-local/katas/ICMwRIPER-5/icmwriper-5-for-ubuntu`
**Target**: `/Users/binwu/OOR-local/katas/ICMwRIPER-5/icmwriper-5-for-macos`

## Changes Required:

### Change 1: Usage Message (Line 5)
```bash
# FROM:
echo "Usage: icmwriper-5 {generate <project-name> | story <story-name> | bubble <bubble-name> | snb <story-name>}"

# TO:
echo "Usage: icmwriper-5-for-macos {generate <project-name> | story <story-name> | bubble <bubble-name> | snb <story-name>}"
```

### Change 2: First sed Command (Line 111)
```bash
# FROM:
sed -i "s/@icm-story-\([0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\}--[0-9]\{2\}-[0-9]\{2\}\|yyyy-mm-dd--hh-mm\)\.md/@$LATEST_STORY/g" "$TARGET_FILE"

# TO:
sed -i '' "s/@icm-story-\([0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\}--[0-9]\{2\}-[0-9]\{2\}\|yyyy-mm-dd--hh-mm\)\.md/@$LATEST_STORY/g" "$TARGET_FILE"
```

### Change 3: Second sed Command (Line 157)
```bash
# FROM:
sed -i "s/@icm-story-\([0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\}--[0-9]\{2\}-[0-9]\{2\}\|yyyy-mm-dd--hh-mm\)\.md/@$STORY_TARGET/g" "$BUBBLE_TARGET"

# TO:
sed -i '' "s/@icm-story-\([0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\}--[0-9]\{2\}-[0-9]\{2\}\|yyyy-mm-dd--hh-mm\)\.md/@$STORY_TARGET/g" "$BUBBLE_TARGET"
```

## Review Section:

### Implementation Summary

Successfully converted `icmwriper-5-for-ubuntu` to `icmwriper-5-for-macos` with full functionality preserved.

### Changes Made:

1. ✅ **Script copy completed**: Created `/Users/binwu/OOR-local/katas/ICMwRIPER-5/icmwriper-5-for-macos`

2. ✅ **Usage message updated**: Changed script name reference from `icmwriper-5` to `icmwriper-5-for-macos` in line 5

3. ✅ **sed commands converted for macOS compatibility**:
   - Added `-E` flag for extended regex support
   - Changed quantifier syntax from `\{n\}` to `{n}`
   - Maintained `-i ''` for in-place editing without backup
   - Both sed commands (lines 111 and 157) successfully updated

4. ✅ **File permissions verified**: Script maintains executable permissions (`-rwxr-xr-x`)

5. ✅ **All subcommands tested successfully**:
   - `generate`: Creates project directory and downloads 4 template files from GitHub
   - `story`: Creates timestamped story files (`icm-story-yyyy-mm-dd--hh-mm.md`)
   - `bubble`: Creates timestamped bubble files using latest story timestamp, updates story references
   - `snb`: Creates matched story-bubble pairs with identical timestamps

### Key Technical Fix:

**Issue discovered**: macOS sed doesn't support basic regex quantifiers `\{n\}` by default
**Solution applied**: Used extended regex mode with `-E` flag and updated quantifier syntax

**Before (Ubuntu)**:
```bash
sed -i "s/@icm-story-\([0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\}--[0-9]\{2\}-[0-9]\{2\}\|yyyy-mm-dd--hh-mm\)\.md/@$LATEST_STORY/g"
```

**After (macOS)**:
```bash
sed -i '' -E "s/@icm-story-([0-9]{4}-[0-9]{2}-[0-9]{2}--[0-9]{2}-[0-9]{2}|yyyy-mm-dd--hh-mm)\.md/@$LATEST_STORY/g"
```

### Testing Results:

All four subcommands tested and verified working correctly:
- ✅ Usage message displays correctly
- ✅ Generate command downloads all template files
- ✅ Story command creates timestamped files
- ✅ Bubble command uses story timestamps and updates references correctly
- ✅ SNB command creates matched pairs with identical timestamps
- ✅ Story reference replacement confirmed working in bubble files

### Conversion Status: ✅ COMPLETE

The macOS script `icmwriper-5-for-macos` successfully implements all functionality from the Ubuntu version and is ready for use on macOS Sequoia 15.6.1 with iTerm2 and zsh.